<% require "base64" %>
apiVersion: apiserver.config.k8s.io/v1
kind: EncryptionConfiguration
resources:
  - resources:
    - secrets
    providers:
<% if p("aes-keys").length > 0 %>
    - aescbc:
        keys:
       <% p("aes-keys").each_with_index do |key, index| %> 
        <% if key.length !=0 %>
          echo "Length of '<%=key%>' not equal to 32"
          exit 1
        <% end %>
        - name: key_<%= index %>
          secret: <%= Base64.encode64(key) %>
       <% end %>
<% end %>
    - identity: {}